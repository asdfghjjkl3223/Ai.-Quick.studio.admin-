        };<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Quick Studio - Super Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut, setPersistence, browserLocalPersistence } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, onSnapshot, doc, updateDoc, increment, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Your Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyAgpcpxQkz9pBPaVuTtPEXvAXIHbxtwX-g",
            authDomain: "ai-quick-studio.firebaseapp.com",
            projectId: "ai-quick-studio",
            storageBucket: "ai-quick-studio.firebasestorage.app",
            messagingSenderId: "43790372617",
            appId: "1:43790372617:web:cbe99f95562e04bba3cdd8"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const provider = new GoogleAuthProvider();

        setPersistence(auth, browserLocalPersistence).catch(err => console.error(err));

        let usersData = [];
        let pendingRequests = [];
        let totalRevenue = 0;

        // ===========================
        // UI & TOGGLE LOGIC
        // ===========================
        window.switchTab = (tabId) => {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.nav-btn').forEach(el => {
                el.classList.remove('text-indigo-400', 'bg-indigo-500', 'bg-opacity-10');
                el.classList.add('text-gray-500');
            });
            
            document.getElementById(tabId).classList.remove('hidden');
            const activeBtn = document.getElementById('nav-' + tabId);
            if(activeBtn) {
                activeBtn.classList.remove('text-gray-500');
                activeBtn.classList.add('text-indigo-400', 'bg-indigo-500', 'bg-opacity-10');
            }
            window.scrollTo({ top: 0, behavior: 'smooth' });
            lucide.createIcons();
        };

        // API Key Visibility Toggle (Eye Button)
        window.toggleVisibility = (inputId) => {
            const input = document.getElementById(inputId);
            const icon = document.getElementById('eye-' + inputId);
            if (input.type === 'password') {
                input.type = 'text';
                icon.setAttribute('data-lucide', 'eye-off');
            } else {
                input.type = 'password';
                icon.setAttribute('data-lucide', 'eye');
            }
            lucide.createIcons();
        };

        // ===========================
        // AUTHENTICATION
        // ===========================
        window.loginAdmin = async () => {
            const btn = document.getElementById('login-btn');
            btn.innerHTML = "Verifying Credentials...";
            try {
                await signInWithPopup(auth, provider);
            } catch (e) { alert("Login Error: " + e.message); btn.innerHTML = "Secure System Login"; }
        };

        window.logoutAdmin = () => { if(confirm("Disconnect from Control Panel?")) signOut(auth); };

        // ===========================
        // SYSTEM SETTINGS & API LOGIC
        // ===========================
        window.saveSettings = async () => {
            const apiKey = document.getElementById('api-key-input').value;
            const hfKey = document.getElementById('hf-key-input').value; // Hugging Face Key
            const prompt = document.getElementById('base-prompt-input').value;
            const btn = document.getElementById('btn-save-settings');
            
            btn.innerHTML = "Encrypting & Saving...";
            btn.disabled = true;

            try {
                await setDoc(doc(db, 'admin_settings', 'global'), {
                    main_api_key: apiKey,
                    hf_api_key: hfKey,
                    base_character_prompt: prompt,
                    last_updated: new Date().toISOString()
                }, { merge: true });
                
                alert("✅ System Configuration Updated Successfully!");
            } catch(e) { alert("Error: " + e.message); }
            
            btn.innerHTML = "Update System Settings";
            btn.disabled = false;
        };

        // ===========================
        // DATABASE LISTENERS
        // ===========================
        const startListeners = () => {
            
            // 1. Listen to Global Settings
            onSnapshot(doc(db, 'admin_settings', 'global'), (docSnap) => {
                if(docSnap.exists()) {
                    const data = docSnap.data();
                    document.getElementById('api-key-input').value = data.main_api_key || '';
                    document.getElementById('hf-key-input').value = data.hf_api_key || '';
                    document.getElementById('base-prompt-input').value = data.base_character_prompt || 'yah wala character';
                }
            });

            // 2. Listen to Users
            onSnapshot(collection(db, 'users'), (snapshot) => {
                usersData = [];
                snapshot.forEach(doc => usersData.push({ id: doc.id, ...doc.data() }));
                document.getElementById('total-users').innerText = usersData.length;
                window.renderUsers();
            });

            // 3. Listen to UPI & Revenue
            onSnapshot(collection(db, 'upi_requests'), (snapshot) => {
                pendingRequests = [];
                totalRevenue = 0;
                
                snapshot.forEach(doc => {
                    const data = doc.data();
                    if(data.status === 'pending') {
                        pendingRequests.push({ id: doc.id, ...data });
                    }
                    if(data.status === 'approved') {
                        totalRevenue += Number(data.amount);
                    }
                });
                
                document.getElementById('pending-upi').innerText = pendingRequests.length;
                document.getElementById('total-revenue').innerText = "₹" + totalRevenue;
                window.renderUPI();
            });
        };

        // ===========================
        // RENDER DATA
        // ===========================
        window.renderUsers = () => {
            const list = document.getElementById('users-list');
            if(usersData.length === 0) {
                list.innerHTML = `<div class="p-8 text-center text-gray-600 border border-dashed border-gray-800 rounded-3xl">No users registered yet.</div>`;
                return;
            }
            list.innerHTML = usersData.map(u => `
                <div class="p-4 bg-gray-900 border border-gray-800 rounded-2xl mb-3 flex justify-between items-center hover:border-indigo-500 hover:border-opacity-30 transition-all">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-indigo-500 bg-opacity-10 rounded-xl flex items-center justify-center text-indigo-400 font-bold border border-indigo-500 border-opacity-20">
                            ${u.name ? u.name.charAt(0).toUpperCase() : 'U'}
                        </div>
                        <div>
                            <p class="font-bold text-sm text-white">${u.name || 'Unknown User'}</p>
                            <p class="text-[10px] text-gray-500 font-mono">${u.email}</p>
                        </div>
                    </div>
                    <div class="bg-black bg-opacity-50 px-3 py-1.5 rounded-lg border border-gray-800 text-right">
                        <p class="text-[8px] text-gray-500 uppercase tracking-widest mb-0.5">Power</p>
                        <p class="font-mono text-sm text-green-400 font-bold">${u.credits || 0} Cr</p>
                    </div>
                </div>
            `).join('');
        };

        window.renderUPI = () => {
            const list = document.getElementById('upi-list');
            if(pendingRequests.length === 0) {
                list.innerHTML = `<div class="p-10 text-center text-gray-600 border-2 border-dashed border-gray-800 rounded-3xl mt-4 flex flex-col items-center"><i data-lucide="check-circle" class="w-10 h-10 mb-2 opacity-50"></i><p>All payments resolved!</p></div>`;
                lucide.createIcons();
                return;
            }
            list.innerHTML = pendingRequests.map(r => `
                <div class="p-5 bg-gradient-to-br from-gray-900 to-black border border-indigo-500 border-opacity-30 rounded-3xl mb-4 relative overflow-hidden shadow-lg shadow-indigo-500/5">
                    <div class="absolute top-0 left-0 w-1 h-full bg-indigo-500"></div>
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h4 class="font-black text-xl text-white">₹${r.amount} <span class="text-xs font-normal text-gray-500">Recharge</span></h4>
                            <p class="text-[10px] text-gray-400 font-mono mt-1">${r.userEmail}</p>
                        </div>
                        <span class="bg-yellow-500 bg-opacity-10 border border-yellow-500 border-opacity-20 text-yellow-500 px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-widest animate-pulse">Pending</span>
                    </div>
                    <div class="bg-black p-4 rounded-2xl border border-gray-800 mb-5">
                        <p class="text-[10px] text-gray-500 uppercase font-bold tracking-widest mb-1">Transaction ID (UTR)</p>
                        <p class="font-mono text-sm text-indigo-400 select-all">${r.trxId}</p>
                    </div>
                    <div class="flex gap-3">
                        <button onclick="window.approvePayment('${r.id}', '${r.userEmail}', '${r.amount}')" class="flex-1 bg-green-500 bg-opacity-20 hover:bg-opacity-30 text-green-400 font-bold py-3.5 rounded-xl text-sm border border-green-500 border-opacity-30 transition-all flex justify-center items-center gap-2">
                            <i data-lucide="check" class="w-4 h-4"></i> Approve
                        </button>
                        <button onclick="window.rejectPayment('${r.id}')" class="flex-1 bg-red-500 bg-opacity-10 hover:bg-opacity-20 text-red-500 font-bold py-3.5 rounded-xl text-sm border border-red-500 border-opacity-20 transition-all">
                            Reject
                        </button>
                    </div>
                </div>
            `).join('');
            lucide.createIcons();
        };

        // ===========================
        // FINANCE ACTIONS
        // ===========================
        window.approvePayment = async (docId, email, amount) => {
            if(!confirm("Authorize payment & transfer credits to user?")) return;
            
            let creditsToAdd = amount === '49' ? 100 : (amount === '149' ? 500 : (amount === '499' ? 2000 : 100));

            try {
                await updateDoc(doc(db, 'upi_requests', docId), { status: 'approved' });
                await updateDoc(doc(db, 'users', email), { credits: increment(creditsToAdd) });
                alert("✅ Payment Authorized! Credits transferred.");
            } catch(e) { alert("Error: " + e.message); }
        };

        window.rejectPayment = async (docId) => {
            if(!confirm("Reject and delete this payment request?")) return;
            try {
                await updateDoc(doc(db, 'upi_requests', docId), { status: 'rejected' });
            } catch(e) { alert("Error: " + e.message); }
        };

        // ===========================
        // INITIALIZATION
        // ===========================
        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('auth-screen').classList.add('hidden');
                document.getElementById('app-interface').classList.remove('hidden');
                document.getElementById('admin-name').innerText = user.displayName.split(' ')[0];
                startListeners();
                lucide.createIcons();
            } else {
                document.getElementById('auth-screen').classList.remove('hidden');
                document.getElementById('app-interface').classList.add('hidden');
            }
        });
    </script>

    <style>
        body { background-color: #02000a; color: #ffffff; font-family: sans-serif; overflow-x: hidden; -webkit-tap-highlight-color: transparent; }
        .hidden { display: none !important; }
        .glass { background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.05); border-radius: 1.5rem; backdrop-filter: blur(10px); }
        .indigo-gradient { background: linear-gradient(135deg, #4f46e5, #312e81); }
        .app-container { padding-bottom: 8rem; }
        ::-webkit-scrollbar { display: none; }
        input, textarea { outline: none; }
        
        .header-fixed { position: sticky; top: 0; z-index: 80; background: rgba(2, 0, 10, 0.95); border-bottom: 1px solid rgba(255,255,255,0.05); }
        .bottom-nav { position: fixed; bottom: 1.5rem; left: 50%; transform: translateX(-50%); width: 92%; max-width: 28rem; z-index: 99; border-radius: 2rem; }
        .fade-in { animation: fadeIn 0.4s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="selection:bg-indigo-500 selection:text-white">

    <div id="auth-screen" class="min-h-screen flex flex-col items-center justify-center p-8 text-center bg-[#02000a] z-50">
        <div class="w-24 h-24 indigo-gradient rounded-[2rem] flex items-center justify-center mx-auto mb-8 shadow-[0_0_50px_rgba(79,70,229,0.3)]">
            <i data-lucide="cpu" class="text-white w-12 h-12"></i>
        </div>
        <h1 class="text-3xl font-black mb-2 tracking-tight text-white">SYSTEM <span class="text-indigo-500">ADMIN</span></h1>
        <p class="text-gray-500 mb-10 font-bold text-xs uppercase tracking-widest">Authorized Personnel Only</p>
        <button id="login-btn" onclick="window.loginAdmin()" class="w-full max-w-sm bg-white text-black font-extrabold py-4 px-6 rounded-2xl flex items-center justify-center gap-3 active:scale-95 transition-all shadow-xl shadow-white/5">
            <img src="https://www.google.com/favicon.ico" class="w-5 h-5"> Authenticate System
        </button>
    </div>

    <div id="app-interface" class="hidden app-container">
        
        <header class="header-fixed p-6 flex justify-between items-center shadow-lg shadow-black">
            <div>
                <p class="text-[10px] uppercase tracking-[0.2em] text-indigo-500 font-bold mb-1 flex items-center gap-1"><span class="w-1.5 h-1.5 bg-indigo-500 rounded-full animate-pulse"></span> Root Access</p>
                <h2 class="text-2xl font-black">Welcome, <span id="admin-name" class="text-white">Admin</span></h2>
            </div>
            <button onclick="window.logoutAdmin()" class="bg-red-500 bg-opacity-10 text-red-500 p-3.5 rounded-2xl border border-red-500 border-opacity-20 active:scale-95">
                <i data-lucide="power" class="w-5 h-5"></i>
            </button>
        </header>

        <div class="p-5 max-w-md mx-auto space-y-6">
            
            <div id="tab-dashboard" class="tab-content fade-in space-y-4">
                <div class="indigo-gradient p-6 rounded-3xl shadow-[0_10px_40px_rgba(79,70,229,0.3)] relative overflow-hidden">
                    <i data-lucide="trending-up" class="absolute -right-4 -bottom-4 w-32 h-32 text-black opacity-20"></i>
                    <p class="text-[10px] text-white/70 font-bold uppercase tracking-widest mb-1">Total Revenue</p>
                    <h2 class="text-5xl font-black text-white" id="total-revenue">₹0</h2>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div class="glass p-5 rounded-3xl border-l-4 border-l-blue-500 bg-gradient-to-br from-gray-900 to-black">
                        <i data-lucide="users" class="text-blue-500 mb-3 w-6 h-6"></i>
                        <p class="text-[10px] text-gray-500 font-bold uppercase">Total Users</p>
                        <h3 id="total-users" class="text-3xl font-black mt-1">0</h3>
                    </div>
                    <div class="glass p-5 rounded-3xl border-l-4 border-l-yellow-500 bg-gradient-to-br from-gray-900 to-black">
                        <i data-lucide="clock" class="text-yellow-500 mb-3 w-6 h-6"></i>
                        <p class="text-[10px] text-gray-500 font-bold uppercase">Pending UPI</p>
                        <h3 id="pending-upi" class="text-3xl font-black mt-1">0</h3>
                    </div>
                </div>
            </div>

            <div id="tab-users" class="tab-content hidden fade-in space-y-4">
                <h3 class="font-black text-xl mb-4 flex items-center gap-2 text-white"><i data-lucide="users" class="w-5 h-5 text-indigo-500"></i> Client CRM</h3>
                <div id="users-list" class="space-y-3">
                    <div class="text-center text-gray-600 animate-pulse py-10">Fetching clients...</div>
                </div>
            </div>

            <div id="tab-upi" class="tab-content hidden fade-in">
                <h3 class="font-black text-xl mb-4 text-white flex items-center gap-2">
                    <i data-lucide="banknote" class="w-5 h-5 text-green-500"></i> Financial Approvals
                </h3>
                <div id="upi-list">
                    <div class="text-center text-gray-600 animate-pulse py-10">Syncing ledgers...</div>
                </div>
            </div>

            <div id="tab-settings" class="tab-content hidden fade-in space-y-5">
                <h3 class="font-black text-xl mb-4 text-white flex items-center gap-2">
                    <i data-lucide="settings-2" class="w-5 h-5 text-purple-500"></i> Global Settings
                </h3>
                
                <div class="glass p-6 rounded-[2rem] border border-purple-500/20 bg-gradient-to-b from-purple-500/5 to-transparent">
                    
                    <div class="mb-5">
                        <label class="text-[10px] font-bold text-purple-400 uppercase tracking-widest flex items-center gap-2 mb-2">
                            <i data-lucide="key" class="w-3 h-3"></i> Master API Key (Gemini)
                        </label>
                        <div class="relative">
                            <input type="password" id="api-key-input" class="w-full bg-black/60 rounded-xl p-4 pr-12 text-sm border border-gray-800 focus:border-purple-500 text-white font-mono" placeholder="sk-...">
                            <button onclick="window.toggleVisibility('api-key-input')" class="absolute right-4 top-4 text-gray-500 hover:text-white transition-colors">
                                <i data-lucide="eye" id="eye-api-key-input" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>

                    <div class="mb-5">
                        <label class="text-[10px] font-bold text-blue-400 uppercase tracking-widest flex items-center gap-2 mb-2">
                            <i data-lucide="cpu" class="w-3 h-3"></i> Hugging Face API Key
                        </label>
                        <div class="relative">
                            <input type="password" id="hf-key-input" class="w-full bg-black/60 rounded-xl p-4 pr-12 text-sm border border-gray-800 focus:border-blue-500 text-white font-mono" placeholder="hf_...">
                            <button onclick="window.toggleVisibility('hf-key-input')" class="absolute right-4 top-4 text-gray-500 hover:text-white transition-colors">
                                <i data-lucide="eye" id="eye-hf-key-input" class="w-5 h-5"></i>
                            </button>
                        </div>
                        <p class="text-[9px] text-gray-500 mt-2">Required for Image & Video generation models.</p>
                    </div>

                    <div class="mb-6">
                        <label class="text-[10px] font-bold text-amber-500 uppercase tracking-widest flex items-center gap-2 mb-2">
                            <i data-lucide="bot" class="w-3 h-3"></i> Base Character Prompt
                        </label>
                        <textarea id="base-prompt-input" rows="3" class="w-full bg-black/60 rounded-xl p-4 text-sm border border-gray-800 focus:border-amber-500 text-amber-500 font-mono resize-none" placeholder="Enter base prompt..."></textarea>
                        <p class="text-[9px] text-gray-500 mt-2">Face-lock text applied to all user generations.</p>
                    </div>

                    <button id="btn-save-settings" onclick="window.saveSettings()" class="w-full bg-white text-black font-black py-4 rounded-xl active:scale-95 transition-all shadow-lg shadow-white/10">
                        Update System Settings
                    </button>
                </div>
            </div>

        </div>

        <nav class="bottom-nav glass flex items-center justify-evenly px-2 bg-[#02000a] bg-opacity-95 backdrop-blur-2xl border border-gray-800 shadow-[0_20px_50px_rgba(0,0,0,0.9)]">
            <button id="nav-tab-dashboard" onclick="window.switchTab('tab-dashboard')" class="nav-btn text-indigo-400 bg-indigo-500 bg-opacity-10 w-14 h-14 rounded-2xl flex flex-col items-center justify-center transition-all">
                <i data-lucide="layout-dashboard" class="w-5 h-5 mb-1"></i>
            </button>
            <button id="nav-tab-users" onclick="window.switchTab('tab-users')" class="nav-btn text-gray-500 w-14 h-14 rounded-2xl flex flex-col items-center justify-center transition-all">
                <i data-lucide="users" class="w-5 h-5 mb-1"></i>
            </button>
            <button id="nav-tab-upi" onclick="window.switchTab('tab-upi')" class="nav-btn text-gray-500 w-14 h-14 rounded-2xl flex flex-col items-center justify-center transition-all relative">
                <i data-lucide="banknote" class="w-5 h-5 mb-1"></i>
            </button>
            <button id="nav-tab-settings" onclick="window.switchTab('tab-settings')" class="nav-btn text-gray-500 w-14 h-14 rounded-2xl flex flex-col items-center justify-center transition-all">
                <i data-lucide="settings-2" class="w-5 h-5 mb-1"></i>
            </button>
        </nav>
    </div>

    <script>
        window.addEventListener('load', () => lucide.createIcons());
    </script>
</body>
</html>

        // Render Users Table
        const renderUsers = () => {
            const list = document.getElementById('users-list');
            if(usersData.length === 0) {
                list.innerHTML = `<div class="p-6 text-center text-zinc-500">No users found.</div>`;
                return;
            }
            list.innerHTML = usersData.map(u => `
                <div class="p-4 border-b border-white/5 flex justify-between items-center bg-zinc-900/50 mb-2 rounded-2xl">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-indigo-500/20 rounded-full flex items-center justify-center text-indigo-400 font-bold border border-indigo-500/30">
                            ${u.name ? u.name.charAt(0) : 'U'}
                        </div>
                        <div>
                            <p class="font-bold text-sm">${u.name || 'Unknown'}</p>
                            <p class="text-xs text-zinc-500">${u.email}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <span class="bg-indigo-500/20 text-indigo-400 px-2 py-1 rounded-md text-[10px] font-bold uppercase mb-1 inline-block">${u.plan || 'FREE'}</span>
                        <p class="font-mono text-sm text-emerald-400 font-bold">${u.credits || 0} Cr</p>
                    </div>
                </div>
            `).join('');
        };

        // Render UPI Requests
        const renderUPI = () => {
            const list = document.getElementById('upi-list');
            if(pendingRequests.length === 0) {
                list.innerHTML = `<div class="p-8 text-center text-zinc-500 border border-dashed border-white/10 rounded-3xl mt-4">No pending payments. You are all caught up!</div>`;
                return;
            }
            list.innerHTML = pendingRequests.map(r => `
                <div class="p-5 glass rounded-3xl mb-4 border border-indigo-500/20">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h4 class="font-black text-lg text-white">₹${r.amount} Recharge</h4>
                            <p class="text-xs text-zinc-400">${r.userEmail}</p>
                        </div>
                        <span class="bg-amber-500/20 text-amber-500 px-2 py-1 rounded text-[10px] font-bold uppercase animate-pulse">Pending</span>
                    </div>
                    <div class="bg-black/50 p-3 rounded-xl border border-white/5 mb-4">
                        <p class="text-[10px] text-zinc-500 uppercase font-bold mb-1">Transaction ID</p>
                        <p class="font-mono text-sm text-indigo-400 select-all">${r.trxId}</p>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="approvePayment('${r.id}', '${r.userEmail}', '${r.amount}')" class="flex-1 bg-emerald-500 text-black font-bold py-3 rounded-xl text-sm active:scale-95 transition-all flex justify-center items-center gap-2">
                            <i data-lucide="check-circle-2" class="w-4 h-4"></i> Approve
                        </button>
                        <button onclick="rejectPayment('${r.id}')" class="flex-1 bg-rose-500/10 text-rose-500 font-bold py-3 rounded-xl text-sm border border-rose-500/20 active:scale-95 transition-all">
                            Reject
                        </button>
                    </div>
                </div>
            `).join('');
            lucide.createIcons();
        };

        // Actions
        window.approvePayment = async (docId, email, amount) => {
            if(!confirm("Approve payment and add credits?")) return;
            try {
                const creditsToAdd = amount === '149' ? 500 : (amount === '499' ? 2000 : 100);
                await updateDoc(doc(db, 'upi_requests', docId), { status: 'approved' });
                await updateDoc(doc(db, 'users', email), { 
                    credits: increment(creditsToAdd),
                    plan: creditsToAdd >= 2000 ? 'PRO' : 'VIP'
                });
                alert("Payment Approved! Credits Sent.");
            } catch(e) { alert("Error: " + e.message); }
        };

        window.rejectPayment = async (docId) => {
            if(!confirm("Reject this payment?")) return;
            await updateDoc(doc(db, 'upi_requests', docId), { status: 'rejected' });
        };

        // Auth Watcher
        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('auth-screen').classList.add('hidden');
                document.getElementById('app-interface').classList.remove('hidden');
                document.getElementById('admin-name').innerText = user.displayName.split(' ')[0];
                startListeners();
            } else {
                document.getElementById('auth-screen').classList.remove('hidden');
                document.getElementById('app-interface').classList.add('hidden');
            }
        });
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #050505; overflow-x: hidden; }
        .indigo-blur { background: radial-gradient(circle at top right, rgba(99, 102, 241, 0.15) 0%, transparent 60%); }
        .glass { background: rgba(255, 255, 255, 0.02); backdrop-filter: blur(10px); }
    </style>
</head>
<body class="text-white">

    <div id="auth-screen" class="min-h-screen flex flex-col items-center justify-center p-8 text-center relative overflow-hidden">
        <div class="absolute inset-0 indigo-blur"></div>
        <div class="relative z-10 w-full max-w-sm">
            <div class="w-20 h-20 bg-indigo-600 rounded-3xl flex items-center justify-center mb-8 mx-auto shadow-[0_0_50px_rgba(79,70,229,0.4)]">
                <i data-lucide="shield-check" class="text-white w-10 h-10"></i>
            </div>
            <h1 class="text-3xl font-extrabold tracking-tight mb-2">ADMIN PRO</h1>
            <p class="text-zinc-500 mb-10 text-sm">Control Panel for AI Quick Studio</p>
            <button id="login-btn" onclick="loginAdmin()" class="w-full bg-white text-black font-extrabold py-4 px-6 rounded-2xl flex items-center justify-center gap-3 active:scale-95 transition-all">
                <img src="https://www.google.com/favicon.ico" class="w-5 h-5">
                Admin Secure Login
            </button>
        </div>
    </div>

    <div id="app-interface" class="hidden min-h-screen pb-24 relative">
        <div class="absolute inset-0 indigo-blur -z-10"></div>
        
        <header class="p-6 flex justify-between items-center sticky top-0 bg-[#050505]/80 backdrop-blur-md z-30 border-b border-white/5">
            <div>
                <p class="text-[10px] uppercase tracking-[0.2em] text-indigo-500 font-bold">Command Center</p>
                <h2 class="text-xl font-bold">Hello, <span id="admin-name" class="text-white">Boss</span></h2>
            </div>
            <button onclick="logoutAdmin()" class="bg-rose-500/10 text-rose-500 p-3 rounded-xl border border-rose-500/20">
                <i data-lucide="power" class="w-5 h-5"></i>
            </button>
        </header>

        <div class="p-6">
            <div id="tab-dashboard" class="tab-content space-y-6 animate-in fade-in duration-300">
                <div class="grid grid-cols-2 gap-4">
                    <div class="glass p-5 rounded-3xl border border-white/5 border-l-4 border-l-blue-500">
                        <i data-lucide="users" class="text-blue-500 mb-2 w-5 h-5"></i>
                        <p class="text-xs text-zinc-500 font-bold uppercase">Total Users</p>
                        <h3 id="total-users" class="text-3xl font-black mt-1">0</h3>
                    </div>
                    <div class="glass p-5 rounded-3xl border border-white/5 border-l-4 border-l-amber-500">
                        <i data-lucide="wallet" class="text-amber-500 mb-2 w-5 h-5"></i>
                        <p class="text-xs text-zinc-500 font-bold uppercase">Pending UPI</p>
                        <h3 id="pending-upi" class="text-3xl font-black mt-1">0</h3>
                    </div>
                </div>

                <div class="glass p-6 rounded-3xl border border-white/5 mt-6 relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-indigo-500/10 rounded-full blur-3xl"></div>
                    <h3 class="font-bold mb-1 flex items-center gap-2 text-indigo-400">
                        <i data-lucide="settings" class="w-4 h-4"></i> Global Engine Settings
                    </h3>
                    <p class="text-xs text-zinc-400 mb-4">Base configuration for all users.</p>
                    
                    <div class="bg-black/50 p-4 rounded-2xl border border-white/5">
                        <p class="text-[10px] text-zinc-500 uppercase font-bold tracking-widest mb-1">Active Face-Lock Prompt</p>
                        <p class="font-mono text-sm text-emerald-400">yah wala character</p>
                    </div>
                </div>
            </div>

            <div id="tab-users" class="tab-content hidden space-y-4 animate-in fade-in duration-300">
                <h3 class="font-black text-xl mb-4">User Registry</h3>
                <div id="users-list" class="space-y-2">
                    <div class="text-center text-zinc-500 animate-pulse">Loading users...</div>
                </div>
            </div>

            <div id="tab-upi" class="tab-content hidden animate-in fade-in duration-300">
                <h3 class="font-black text-xl mb-4 text-amber-500 flex items-center gap-2">
                    <i data-lucide="indian-rupee" class="w-6 h-6"></i> Action Required
                </h3>
                <div id="upi-list">
                    <div class="text-center text-zinc-500 animate-pulse">Scanning database...</div>
                </div>
            </div>
        </div>

        <nav class="fixed bottom-6 left-6 right-6 glass h-16 rounded-[2rem] flex items-center justify-around px-2 z-40 border border-white/10 shadow-2xl shadow-black">
            <button id="nav-tab-dashboard" onclick="switchTab('tab-dashboard')" class="nav-btn text-indigo-400 bg-indigo-500/10 p-3 rounded-2xl transition-all flex flex-col items-center">
                <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
            </button>
            <button id="nav-tab-users" onclick="switchTab('tab-users')" class="nav-btn text-zinc-500 hover:text-white p-3 rounded-2xl transition-all flex flex-col items-center">
                <i data-lucide="users" class="w-5 h-5"></i>
            </button>
            <button id="nav-tab-upi" onclick="switchTab('tab-upi')" class="nav-btn text-zinc-500 hover:text-white p-3 rounded-2xl transition-all flex flex-col items-center relative">
                <i data-lucide="check-circle" class="w-5 h-5"></i>
            </button>
        </nav>
    </div>

    <script>lucide.createIcons();</script>
</body>
  </html>
